<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:di="http://www.omg.org/spec/DD/20100524/DI" targetNamespace="http://bpmn.io/schema/bpmn" exporter="bpmn-js (https://demo.bpmn.io)" exporterVersion="18.6.1">
  <process id="Process_1" isExecutable="false">
    <startEvent id="StartEvent_1" name="Начало регистрации">
      <outgoing>Flow_1</outgoing>
    </startEvent>
    <userTask id="UserTask_1" name="Ввести данные регистрации (имя, email, пароль)">
      <incoming>Flow_1</incoming>
      <outgoing>Flow_2</outgoing>
    </userTask>
    <sendTask id="SendTask_1" name="Отправить данные">
      <incoming>Flow_2</incoming>
      <outgoing>Flow_3</outgoing>
    </sendTask>
    <receiveTask id="ReceiveTask_1" name="Получить данные для регистрации">
      <incoming>Flow_3</incoming>
      <outgoing>Flow_4</outgoing>
    </receiveTask>
    <exclusiveGateway id="Gateway_1" name="Данные корректны?">
      <incoming>Flow_4</incoming>
      <outgoing>Flow_5</outgoing>
      <outgoing>Flow_6</outgoing>
    </exclusiveGateway>
    <userTask id="UserTask_2" name="Показать ошибку валидации">
      <incoming>Flow_5</incoming>
      <outgoing>Flow_7</outgoing>
    </userTask>
    <endEvent id="EndEvent_1" name="Регистрация отклонена">
      <incoming>Flow_7</incoming>
    </endEvent>
    <serviceTask id="ServiceTask_1" name="Создать запись пользователя">
      <incoming>Flow_6</incoming>
      <outgoing>Flow_8</outgoing>
    </serviceTask>
    <sendTask id="SendTask_2" name="Отправить письмо с ссылкой для подтверждения">
      <incoming>Flow_8</incoming>
      <outgoing>Flow_9</outgoing>
    </sendTask>
    <intermediateCatchEvent id="TimerEvent_1" name="Ожидание подтверждения">
      <incoming>Flow_9</incoming>
      <outgoing>Flow_10</outgoing>
      <timerEventDefinition />
    </intermediateCatchEvent>
    <exclusiveGateway id="Gateway_2" name="Подтверждение получено?">
      <incoming>Flow_10</incoming>
      <outgoing>Flow_11</outgoing>
      <outgoing>Flow_12</outgoing>
    </exclusiveGateway>
    <serviceTask id="ServiceTask_2" name="Пометить запись как &#39;просрочена&#39; и удалить">
      <incoming>Flow_11</incoming>
      <outgoing>Flow_13</outgoing>
    </serviceTask>
    <endEvent id="EndEvent_2" name="Регистрация отменена (тайм-аут)">
      <incoming>Flow_13</incoming>
    </endEvent>
    <userTask id="UserTask_3" name="Перейти по ссылке из письма">
      <incoming>Flow_12</incoming>
      <outgoing>Flow_14</outgoing>
    </userTask>
    <serviceTask id="ServiceTask_3" name="Активировать учетную запись пользователя">
      <incoming>Flow_14</incoming>
      <outgoing>Flow_15</outgoing>
    </serviceTask>
    <endEvent id="EndEvent_3" name="Регистрация завершена успешно">
      <incoming>Flow_15</incoming>
    </endEvent>
    <sequenceFlow id="Flow_1" sourceRef="StartEvent_1" targetRef="UserTask_1" />
    <sequenceFlow id="Flow_2" sourceRef="UserTask_1" targetRef="SendTask_1" />
    <sequenceFlow id="Flow_3" sourceRef="SendTask_1" targetRef="ReceiveTask_1" />
    <sequenceFlow id="Flow_4" sourceRef="ReceiveTask_1" targetRef="Gateway_1" />
    <sequenceFlow id="Flow_5" name="Некорректные данные" sourceRef="Gateway_1" targetRef="UserTask_2" />
    <sequenceFlow id="Flow_6" name="Данные корректны" sourceRef="Gateway_1" targetRef="ServiceTask_1" />
    <sequenceFlow id="Flow_7" sourceRef="UserTask_2" targetRef="EndEvent_1" />
    <sequenceFlow id="Flow_8" sourceRef="ServiceTask_1" targetRef="SendTask_2" />
    <sequenceFlow id="Flow_9" sourceRef="SendTask_2" targetRef="TimerEvent_1" />
    <sequenceFlow id="Flow_10" sourceRef="TimerEvent_1" targetRef="Gateway_2" />
    <sequenceFlow id="Flow_11" name="Тайм-аут" sourceRef="Gateway_2" targetRef="ServiceTask_2" />
    <sequenceFlow id="Flow_12" name="Подтверждение получено" sourceRef="Gateway_2" targetRef="UserTask_3" />
    <sequenceFlow id="Flow_13" sourceRef="ServiceTask_2" targetRef="EndEvent_2" />
    <sequenceFlow id="Flow_14" sourceRef="UserTask_3" targetRef="ServiceTask_3" />
    <sequenceFlow id="Flow_15" sourceRef="ServiceTask_3" targetRef="EndEvent_3" />
  </process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_1">
    <bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="Process_1">
      <bpmndi:BPMNShape id="StartEvent_1_di" bpmnElement="StartEvent_1">
        <dc:Bounds x="152" y="102" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="UserTask_1_di" bpmnElement="UserTask_1">
        <dc:Bounds x="240" y="80" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="SendTask_1_di" bpmnElement="SendTask_1">
        <dc:Bounds x="390" y="80" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="ReceiveTask_1_di" bpmnElement="ReceiveTask_1">
        <dc:Bounds x="540" y="80" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_1_di" bpmnElement="Gateway_1" isMarkerVisible="true">
        <dc:Bounds x="690" y="95" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="650" y="76" width="60" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="UserTask_2_di" bpmnElement="UserTask_2">
        <dc:Bounds x="790" y="180" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="ServiceTask_1_di" bpmnElement="ServiceTask_1">
        <dc:Bounds x="790" y="80" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="SendTask_2_di" bpmnElement="SendTask_2">
        <dc:Bounds x="940" y="80" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="TimerEvent_1_di" bpmnElement="TimerEvent_1">
        <dc:Bounds x="1090" y="102" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_2_di" bpmnElement="Gateway_2" isMarkerVisible="true">
        <dc:Bounds x="1176" y="95" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1119" y="76" width="82" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="ServiceTask_2_di" bpmnElement="ServiceTask_2">
        <dc:Bounds x="1276" y="180" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="UserTask_3_di" bpmnElement="UserTask_3">
        <dc:Bounds x="1276" y="80" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="ServiceTask_3_di" bpmnElement="ServiceTask_3">
        <dc:Bounds x="1426" y="80" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="EndEvent_3_di" bpmnElement="EndEvent_3">
        <dc:Bounds x="1576" y="102" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="EndEvent_1_di" bpmnElement="EndEvent_1">
        <dc:Bounds x="952" y="202" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="938" y="238" width="65" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="EndEvent_2_di" bpmnElement="EndEvent_2">
        <dc:Bounds x="1426" y="202" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1402" y="238" width="85" height="40" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="Flow_1_di" bpmnElement="Flow_1">
        <di:waypoint x="188" y="120" />
        <di:waypoint x="240" y="120" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_2_di" bpmnElement="Flow_2">
        <di:waypoint x="340" y="120" />
        <di:waypoint x="390" y="120" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_3_di" bpmnElement="Flow_3">
        <di:waypoint x="490" y="120" />
        <di:waypoint x="540" y="120" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_4_di" bpmnElement="Flow_4">
        <di:waypoint x="640" y="120" />
        <di:waypoint x="690" y="120" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_5_di" bpmnElement="Flow_5">
        <di:waypoint x="715" y="145" />
        <di:waypoint x="715" y="220" />
        <di:waypoint x="790" y="220" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="713" y="233" width="74" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_6_di" bpmnElement="Flow_6">
        <di:waypoint x="740" y="120" />
        <di:waypoint x="790" y="120" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="723" y="76" width="54" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_7_di" bpmnElement="Flow_7">
        <di:waypoint x="890" y="220" />
        <di:waypoint x="952" y="220" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_8_di" bpmnElement="Flow_8">
        <di:waypoint x="890" y="120" />
        <di:waypoint x="940" y="120" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_9_di" bpmnElement="Flow_9">
        <di:waypoint x="1040" y="120" />
        <di:waypoint x="1090" y="120" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_10_di" bpmnElement="Flow_10">
        <di:waypoint x="1126" y="120" />
        <di:waypoint x="1176" y="120" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_11_di" bpmnElement="Flow_11">
        <di:waypoint x="1201" y="145" />
        <di:waypoint x="1201" y="220" />
        <di:waypoint x="1276" y="220" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1206" y="183" width="47" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_12_di" bpmnElement="Flow_12">
        <di:waypoint x="1226" y="120" />
        <di:waypoint x="1276" y="120" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1209" y="66" width="82" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_13_di" bpmnElement="Flow_13">
        <di:waypoint x="1376" y="220" />
        <di:waypoint x="1426" y="220" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_14_di" bpmnElement="Flow_14">
        <di:waypoint x="1376" y="120" />
        <di:waypoint x="1426" y="120" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_15_di" bpmnElement="Flow_15">
        <di:waypoint x="1526" y="120" />
        <di:waypoint x="1576" y="120" />
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</definitions>
